{% load static %}
{% comment %}
PHASE 3: UNIFIED BASE TEMPLATE
Date: August 26, 2025
Purpose: Single base template unifying base.html and routinetest_base.html
Supports: Both placement_test and primepath_routinetest modules
{% endcomment %}

<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}PrimePath Assessment Platform{% endblock %}</title>
    
    <!-- Favicon (unified from both templates) -->
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
    <link rel="icon" type="image/svg+xml" href="{% static 'favicon.svg' %}">
    <link rel="shortcut icon" href="{% static 'favicon.ico' %}">
    
    <!-- Core CSS - Order matters for cascade -->
    <link rel="stylesheet" href="{% static 'css/mobile-responsive.css' %}">
    
    <!-- Module-specific base styles -->
    {% block module_css %}
        <!-- Templates can override to load module-specific CSS -->
        <!-- For RoutineTest: primepath_brand.css, unified-design-system.css, etc. -->
        <!-- For PlacementTest: placement-specific styles -->
    {% endblock %}
    
    <!-- Extra CSS for specific pages -->
    {% block extra_css %}{% endblock %}
    
    <!-- JavaScript Configuration (unified approach) -->
    <script>
        // Unified configuration object
        window.PRIMEPATH_CONFIG = {
            module: '{% block module_name %}core{% endblock %}',
            debug: {% if debug %}true{% else %}false{% endif %},
            csrfToken: '{{ csrf_token }}',
            staticUrl: '{% static "" %}',
            timestamp: new Date().toISOString()
        };
        
        // Module-specific flags (backward compatibility)
        {% block js_config %}
            // Templates can add module-specific config here
        {% endblock %}
    </script>
    
    <!-- Base styles (consolidated from both templates) -->
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            font-size: {% block base_font_size %}16px{% endblock %};  /* Configurable */
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Container (from base.html) */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header (flexible for both styles) */
        .header {
            background-color: {% block header_bg_color %}#2c3e50{% endblock %};
            color: white;
            padding: 20px 0;
            margin-bottom: {% block header_margin %}30px{% endblock %};
        }
        
        .header h1 {
            text-align: center;
            font-size: 2rem;
        }
        
        /* Main content area */
        .main-content {
            min-height: calc(100vh - 200px);
        }
        
        .content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* Button styles (base) */
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        /* Typography hierarchy (from routinetest_base) */
        h1 { font-size: 32px; line-height: 1.25; font-weight: 600; margin-bottom: 24px; }
        h2 { font-size: 24px; line-height: 1.25; font-weight: 600; margin-bottom: 20px; }
        h3 { font-size: 20px; line-height: 1.3; font-weight: 600; margin-bottom: 16px; }
        h4 { font-size: 18px; line-height: 1.3; font-weight: 500; margin-bottom: 16px; }
        p { margin-bottom: 16px; line-height: 1.5; }
        
        /* Additional base styles can be added here */
        {% block base_styles %}{% endblock %}
    </style>
</head>

<body class="{% block body_class %}{% endblock %}" data-module="{% block data_module %}{% endblock %}">
    
    <!-- Skip to main content (accessibility) -->
    <a href="#main" class="sr-only">Skip to main content</a>
    
    <!-- Header Section (flexible) -->
    {% block header_wrapper %}
    <header class="header {% block header_class %}{% endblock %}">
        {% block header %}
            <div class="container">
                <h1>{% block header_title %}PrimePath Assessment Platform{% endblock %}</h1>
                {% block header_subtitle %}{% endblock %}
            </div>
        {% endblock %}
    </header>
    {% endblock %}
    
    <!-- Navigation Section (flexible for different navigation styles) -->
    {% block navigation_wrapper %}
        {% block navigation %}
            <!-- Navigation can be inserted here by child templates -->
            <!-- RoutineTest: Tab navigation -->
            <!-- PlacementTest: Menu navigation -->
        {% endblock %}
    {% endblock %}
    
    <!-- Messages/Alerts Section -->
    {% block messages %}
        {% if messages %}
        <div class="container">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible">
                {{ message }}
                <button type="button" class="close" data-dismiss="alert">&times;</button>
            </div>
            {% endfor %}
        </div>
        {% endif %}
    {% endblock %}
    
    <!-- Main Content Area -->
    <main id="main" class="main-content">
        {% block content_wrapper %}
            <div class="container">
                {% block content %}
                    <!-- Main content goes here -->
                {% endblock %}
            </div>
        {% endblock %}
    </main>
    
    <!-- Footer Section -->
    {% block footer_wrapper %}
        {% block footer %}
            <!-- Footer content can be added by child templates -->
        {% endblock %}
    {% endblock %}
    
    <!-- Core JavaScript (order matters) -->
    {% block core_js %}
        <!-- Core JavaScript that all modules need -->
        <!-- Will be created as unified-core.js -->
    {% endblock %}
    
    <!-- Module-specific JavaScript -->
    {% block module_js %}
        <!-- RoutineTest or PlacementTest specific JS -->
    {% endblock %}
    
    <!-- Page-specific JavaScript -->
    {% block extra_js %}
        <!-- Additional JavaScript for specific pages -->
    {% endblock %}
    
    <!-- Debug/Development JavaScript -->
    {% if debug %}
    <script>
        console.log('[UNIFIED_BASE] Template loaded successfully');
        console.log('[UNIFIED_BASE] Module:', window.PRIMEPATH_CONFIG.module);
        console.log('[UNIFIED_BASE] Debug mode:', window.PRIMEPATH_CONFIG.debug);
    </script>
    {% endif %}
</body>
</html>